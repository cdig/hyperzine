// Generated by CoffeeScript 2.5.1
// setup-assistant/coffee/gear-view.coffee
// We keep this separate from the main setup-assistant.coffee so that it can run immediately, and not wait on other systems like IPC
var indexOf = [].indexOf;

Take(["GearView"], function(GearView) {
  return GearView(60, -99);
});

// setup-assistant/setup-assistant.coffee
Take(["DOOM", "Env", "IPC", "Log", "Memory", "Read", "DOMContentLoaded"], function(DOOM, Env, IPC, Log, Memory, Read) {
  var clearFocus, click, elm, elms, focus, i, inputIsFocused, inputs, len, localNameValid, n, previousInputValue, q, ref, resetValue, to, wait;
  previousInputValue = null;
  q = function(k) {
    return document.querySelector(k); // Ugh so repetitive
  };
  elms = {
    pathReason: q("[path-reason]"),
    dataFolder: q("[data-folder]"),
    localName: q("[local-name]"),
    existingAssets: q("[existing-assets]")
  };
  inputs = [];
  focus = function(e) {
    return previousInputValue = e.currentTarget.textContent;
  };
  ref = ["localName"];
  for (i = 0, len = ref.length; i < len; i++) {
    n = ref[i];
    inputs.push(elm = elms[n]);
    elm.addEventListener("focus", focus);
  }
  click = function(n, fn) {
    return q(n).onclick = fn;
  };
  wait = function() {
    return new Promise(function(resolve) {
      var waitTime;
      waitTime = parseInt(document.documentElement.computedStyleMap().get("--time")[0]);
      return setTimeout(resolve, waitTime * 1000);
    });
  };
  to = function(n) {
    return async function() {
      document.body.className = n;
      if (elm = q("[is-showing]")) {
        DOOM(elm, {
          isShowing: null,
          pointerEvents: null
        });
      }
      elm = document.getElementById(n);
      DOOM(elm, {
        isShowing: ""
      });
      clearFocus();
      await wait(); // unless Env.isDev
      return DOOM(elm, {
        pointerEvents: "auto"
      });
    };
  };
  inputIsFocused = function() {
    var ref1;
    return ref1 = document.activeElement, indexOf.call(inputs, ref1) >= 0;
  };
  clearFocus = function() {
    document.activeElement.blur();
    return window.getSelection().empty();
  };
  resetValue = function() {
    return document.activeElement.textContent = previousInputValue;
  };
  // Block newlines in typable fields (needs to be keydown to avoid flicker)
  window.addEventListener("keydown", function(e) {
    if (e.keyCode === 13) {
      return e.preventDefault();
    }
  });
  // Alternative to clicking buttons (needs to be keyup to avoid inadvertant key repeat)
  window.addEventListener("keydown", function(e) {
    var ref1, ref2;
    switch (e.keyCode) {
      case 13:
        return (ref1 = q("[is-showing] [next-button]")) != null ? ref1.click() : void 0;
      case 27:
        if (inputIsFocused()) {
          resetValue();
          return clearFocus();
        } else {
          return (ref2 = q("[is-showing] [back-button]")) != null ? ref2.click() : void 0;
        }
    }
  });
  // Screens #######################################################################################

  // Init
  to("welcome")();
  // Welcome
  click("[quit-button]", function() {
    return IPC.send(Memory("setupDone") ? "close-window" : "quit");
  });
  Memory.subscribe("setupDone", true, function(v) {
    return q("[quit-button]").textContent = v ? "Close" : "Quit";
  });
  click("#welcome [next-button]", to("data-folder"));
  // Data Folder
  click("#data-folder [back-button]", to("welcome"));
  click("#data-folder [select-folder]", async function() {
    var newFolder, res;
    res = (await IPC.invoke("showOpenDialog", {
      defaultPath: Env.home,
      properties: ["openDirectory", "createDirectory"]
    }));
    if (!res.cancelled) {
      newFolder = res.filePaths[0];
      return Memory.change("dataFolder", newFolder);
    }
  });
  Memory.subscribe("dataFolder", true, function(v) {
    var display;
    if (v == null) {
      return;
    }
    display = v;
    if (display !== Env.home) {
      display = display.replace(Env.home, "");
    }
    if (display.charAt(0) === Read.sep) {
      display = display.slice(1);
    }
    elms.dataFolder.textContent = display;
    elms.pathReason.textContent = v === Env.defaultDataFolder ? "This Dropbox folder is the default:" : "This is the folder you selected:";
    return elms.existingAssets.textContent = "Scanning asset folderâ€¦";
  });
  click("#data-folder [next-button]", async function() {
    return to((await Read.isFolder(Memory("dataFolder"))) ? "existing-assets" : "path-error")();
  });
  // Path Error
  click("#path-error [back-button]", to("data-folder"));
  // Existing Assets
  click("#existing-assets [back-button]", to("data-folder"));
  Memory.subscribe("assets", true, function(v) {
    var count;
    if (v == null) {
      return;
    }
    count = Object.keys(v).length;
    return elms.existingAssets.textContent = String.pluralize(count, "Found %% Asset");
  });
  click("#existing-assets [next-button]", to("local-name"));
  // Local Name
  click("#local-name [back-button]", to("existing-assets"));
  Memory.subscribe("localName", true, function(v) {
    return elms.localName.textContent = v;
  });
  localNameValid = function() {
    return -1 === elms.localName.textContent.trim().search(/[^\w ]/);
  };
  elms.localName.addEventListener("input", function(e) {
    return elms.localName.className = localNameValid() ? "field" : "field invalid";
  });
  click("#local-name [next-button]", function() {
    var v;
    v = elms.localName.textContent.trim();
    if (!(v.length && localNameValid())) {
      return;
    }
    // TODO: check whether any assets already exist using the local name. If so, show a warning. Otherwise...
    Memory.change("localName", v);
    return to("setup-done")();
  });
  // Setup Done
  click("#setup-done [back-button]", to("local-name"));
  return click("#setup-done [next-button]", function() {
    Memory.change("setupDone", true);
    IPC.send("config-ready");
    return IPC.send("close-window");
  });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dXAtYXNzaXN0YW50LmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJ0ZW1wL3NldHVwLWFzc2lzdGFudC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUdtSTs7QUFBQSxJQUFBOztBQUNuSSxJQUFBLENBQUssQ0FBQyxVQUFELENBQUwsRUFBbUIsUUFBQSxDQUFDLFFBQUQsQ0FBQTtTQUNqQixRQUFBLENBQVMsRUFBVCxFQUFhLENBQUMsRUFBZDtBQURpQixDQUFuQixFQURtSTs7O0FBTW5JLElBQUEsQ0FBSyxDQUFDLE1BQUQsRUFBUyxLQUFULEVBQWdCLEtBQWhCLEVBQXVCLEtBQXZCLEVBQThCLFFBQTlCLEVBQXdDLE1BQXhDLEVBQWdELGtCQUFoRCxDQUFMLEVBQTBFLFFBQUEsQ0FBQyxJQUFELEVBQU8sR0FBUCxFQUFZLEdBQVosRUFBaUIsR0FBakIsRUFBc0IsTUFBdEIsRUFBOEIsSUFBOUIsQ0FBQTtBQUUxRSxNQUFBLFVBQUEsRUFBQSxLQUFBLEVBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxLQUFBLEVBQUEsQ0FBQSxFQUFBLGNBQUEsRUFBQSxNQUFBLEVBQUEsR0FBQSxFQUFBLGNBQUEsRUFBQSxDQUFBLEVBQUEsa0JBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLFVBQUEsRUFBQSxFQUFBLEVBQUE7RUFBRSxrQkFBQSxHQUFxQjtFQUVyQixDQUFBLEdBQUksUUFBQSxDQUFDLENBQUQsQ0FBQTtXQUFNLFFBQVEsQ0FBQyxhQUFULENBQXVCLENBQXZCLEVBQU47RUFBQTtFQUVKLElBQUEsR0FDRTtJQUFBLFVBQUEsRUFBWSxDQUFBLENBQUUsZUFBRixDQUFaO0lBQ0EsVUFBQSxFQUFZLENBQUEsQ0FBRSxlQUFGLENBRFo7SUFFQSxTQUFBLEVBQVcsQ0FBQSxDQUFFLGNBQUYsQ0FGWDtJQUdBLGNBQUEsRUFBZ0IsQ0FBQSxDQUFFLG1CQUFGO0VBSGhCO0VBS0YsTUFBQSxHQUFTO0VBRVQsS0FBQSxHQUFRLFFBQUEs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QUFmLEdBQTZCO0VBREssQ0FBcEM7RUFHQSxjQUFBLEdBQWlCLFFBQUEsQ0FBQSxDQUFBO0FBQ2YsV0FBTyxDQUFDLENBQUQsS0FBTSxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxJQUEzQixDQUFBLENBQWlDLENBQUMsTUFBbEMsQ0FBeUMsUUFBekM7RUFERTtFQUdqQixJQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFmLENBQWdDLE9BQWhDLEVBQXlDLFFBQUEsQ0FBQyxDQUFELENBQUE7V0FDdkMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFmLEdBQThCLGNBQUEsQ0FBQSxDQUFILEdBQXlCLE9BQXpCLEdBQXNDO0VBRDFCLENBQXpDO0VBR0EsS0FBQSxDQUFNLDJCQUFOLEVBQW1DLFFBQUEsQ0FBQSxDQUFBO0FBQ3JDLFFBQUE7SUFBSSxDQUFBLEdBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsSUFBM0IsQ0FBQTtJQUNKLE1BQWMsQ0FBQyxDQUFDLE1BQUYsSUFBYSxjQUFBLENBQUEsRUFBM0I7QUFBQSxhQUFBO0tBREo7O0lBR0ksTUFBTSxDQUFDLE1BQVAsQ0FBYyxXQUFkLEVBQTJCLENBQTNCO1dBQ0csRUFBQSxDQUFHLFlBQUg7RUFMOEIsQ0FBbkMsRUFqSUY7O0VBeUlFLEtBQUEsQ0FBTSwyQkFBTixFQUFtQyxFQUFBLENBQUcsWUFBSCxDQUFuQztTQUNBLEtBQUEsQ0FBTSwyQkFBTixFQUFtQyxRQUFBLENBQUEsQ0FBQTtJQUNqQyxNQUFNLENBQUMsTUFBUCxDQUFjLFdBQWQsRUFBMkIsSUFBM0I7SUFDQSxHQUFHLENBQUMsSUFBSixDQUFTLGNBQVQ7V0FDQSxHQUFHLENBQUMsSUFBSixDQUFTLGNBQVQ7RUFIaUMsQ0FBbkM7QUE1SXdFLENBQTFFIiwic291cmNlc0NvbnRlbnQiOlsiXG5cbiMgc2V0dXAtYXNzaXN0YW50L2NvZmZlZS9nZWFyLXZpZXcuY29mZmVlXG4jIFdlIGtlZXAgdGhpcyBzZXBhcmF0ZSBmcm9tIHRoZSBtYWluIHNldHVwLWFzc2lzdGFudC5jb2ZmZWUgc28gdGhhdCBpdCBjYW4gcnVuIGltbWVkaWF0ZWx5LCBhbmQgbm90IHdhaXQgb24gb3RoZXIgc3lzdGVtcyBsaWtlIElQQ1xuVGFrZSBbXCJHZWFyVmlld1wiXSwgKEdlYXJWaWV3KS0+XG4gIEdlYXJWaWV3IDYwLCAtOTlcblxuXG4jIHNldHVwLWFzc2lzdGFudC9zZXR1cC1hc3Npc3RhbnQuY29mZmVlXG5UYWtlIFtcIkRPT01cIiwgXCJFbnZcIiwgXCJJUENcIiwgXCJMb2dcIiwgXCJNZW1vcnlcIiwgXCJSZWFkXCIsIFwiRE9NQ29udGVudExvYWRlZFwiXSwgKERPT00sIEVudiwgSVBDLCBMb2csIE1lbW9yeSwgUmVhZCktPlxuXG4gIHByZXZpb3VzSW5wdXRWYWx1ZSA9IG51bGxcblxuICBxID0gKGspLT4gZG9jdW1lbnQucXVlcnlTZWxlY3RvciBrICMgVWdoIHNvIHJlcGV0aXRpdmVcblxuICBlbG1zID1cbiAgICBwYXRoUmVhc29uOiBxIFwiW3BhdGgtcmVhc29uXVwiXG4gICAgZGF0YUZvbGRlcjogcSBcIltkYXRhLWZvbGRlcl1cIlxuICAgIGxvY2FsTmFtZTogcSBcIltsb2NhbC1uYW1lXVwiXG4gICAgZXhpc3RpbmdBc3NldHM6IHEgXCJbZXhpc3RpbmctYXNzZXRzXVwiXG5cbiAgaW5wdXRzID0gW11cblxuICBmb2N1cyA9IChlKS0+IHByZXZpb3VzSW5wdXRWYWx1ZSA9IGUuY3VycmVudFRhcmdldC50ZXh0Q29udGVudFxuXG4gIGZvciBuIGluIFtcImxvY2FsTmFtZVwiXVxuICAgIGlucHV0cy5wdXNoIGVsbSA9IGVsbXNbbl1cbiAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lciBcImZvY3VzXCIsIGZvY3VzXG5cbiAgY2xpY2sgPSAobiwgZm4pLT5cbiAgICBxKG4pLm9uY2xpY2sgPSBmblxuXG4gIHdhaXQgPSAoKS0+XG4gICAgbmV3IFByb21pc2UgKHJlc29sdmUpLT5cbiAgICAgIHdhaXRUaW1lID0gcGFyc2VJbnQgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbXB1dGVkU3R5bGVNYXAoKS5nZXQoXCItLXRpbWVcIilbMF1cbiAgICAgIHNldFRpbWVvdXQgcmVzb2x2ZSwgd2FpdFRpbWUgKiAxMDAwXG5cbiAgdG8gPSAobiktPiAoKS0+XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc05hbWUgPSBuXG4gICAgaWYgZWxtID0gcShcIltpcy1zaG93aW5nXVwiKVxuICAgICAgRE9PTSBlbG0sIGlzU2hvd2luZzogbnVsbCwgcG9pbnRlckV2ZW50czogbnVsbFxuICAgIGVsbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkIG5cbiAgICBET09NIGVsbSwgaXNTaG93aW5nOiBcIlwiXG4gICAgY2xlYXJGb2N1cygpXG4gICAgYXdhaXQgd2FpdCgpIyB1bmxlc3MgRW52LmlzRGV2XG4gICAgRE9PTSBlbG0sIHBvaW50ZXJFdmVudHM6IFwiYXV0b1wiXG5cbiAgaW5wdXRJc0ZvY3VzZWQgPSAoKS0+XG4gICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBpbiBpbnB1dHNcblxuICBjbGVhckZvY3VzID0gKCktPlxuICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpXG4gICAgd2luZG93LmdldFNlbGVjdGlvbigpLmVtcHR5KClcblxuICByZXNldFZhbHVlID0gKCktPlxuICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQudGV4dENvbnRlbnQgPSBwcmV2aW91c0lucHV0VmFsdWVcblxuICAjIEJsb2NrIG5ld2xpbmVzIGluIHR5cGFibGUgZmllbGRzIChuZWVkcyB0byBiZSBrZXlkb3duIHRvIGF2b2lkIGZsaWNrZXIpXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyIFwia2V5ZG93blwiLCAoZSktPlxuICAgIGUucHJldmVudERlZmF1bHQoKSBpZiBlLmtleUNvZGUgaXMgMTNcblxuICAjIEFsdGVybmF0aXZlIHRvIGNsaWNraW5nIGJ1dHRvbnMgKG5lZWRzIHRvIGJlIGtleXVwIHRvIGF2b2lkIGluYWR2ZXJ0YW50IGtleSByZXBlYXQpXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyIFwia2V5ZG93blwiLCAoZSktPlxuICAgIHN3aXRjaCBlLmtleUNvZGVcbiAgICAgIHdoZW4gMTNcbiAgICAgICAgcShcIltpcy1zaG93aW5nXSBbbmV4dC1idXR0b25dXCIpPy5jbGljaygpXG5cbiAgICAgIHdoZW4gMjdcbiAgICAgICAgaWYgaW5wdXRJc0ZvY3VzZWQoKVxuICAgICAgICAgIHJlc2V0VmFsdWUoKVxuICAgICAgICAgIGNsZWFyRm9jdXMoKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgcShcIltpcy1zaG93aW5nXSBbYmFjay1idXR0b25dXCIpPy5jbGljaygpXG5cblxuICAjIFNjcmVlbnMgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXG5cbiAgIyBJbml0XG4gIGRvIHRvIFwid2VsY29tZVwiXG5cbiAgIyBXZWxjb21lXG4gIGNsaWNrIFwiW3F1aXQtYnV0dG9uXVwiLCAoKS0+XG4gICAgSVBDLnNlbmQgaWYgTWVtb3J5IFwic2V0dXBEb25lXCIgdGhlbiBcImNsb3NlLXdpbmRvd1wiIGVsc2UgXCJxdWl0XCJcblxuICBNZW1vcnkuc3Vic2NyaWJlIFwic2V0dXBEb25lXCIsIHRydWUsICh2KS0+XG4gICAgcShcIltxdWl0LWJ1dHRvbl1cIikudGV4dENvbnRlbnQgPSBpZiB2IHRoZW4gXCJDbG9zZVwiIGVsc2UgXCJRdWl0XCJcblxuICBjbGljayBcIiN3ZWxjb21lIFtuZXh0LWJ1dHRvbl1cIiwgdG8gXCJkYXRhLWZvbGRlclwiXG5cbiAgIyBEYXRhIEZvbGRlclxuICBjbGljayBcIiNkYXRhLWZvbGRlciBbYmFjay1idXR0b25dXCIsIHRvIFwid2VsY29tZVwiXG5cbiAgY2xpY2sgXCIjZGF0YS1mb2xkZXIgW3NlbGVjdC1mb2xkZXJdXCIsICgpLT5cbiAgICByZXMgPSBhd2FpdCBJUEMuaW52b2tlIFwic2hvd09wZW5EaWFsb2dcIixcbiAgICAgIGRlZmF1bHRQYXRoOiBFbnYuaG9tZVxuICAgICAgcHJvcGVydGllczogW1wib3BlbkRpcmVjdG9yeVwiLCBcImNyZWF0ZURpcmVjdG9yeVwiXVxuICAgIHVubGVzcyByZXMuY2FuY2VsbGVkXG4gICAgICBuZXdGb2xkZXIgPSByZXMuZmlsZVBhdGhzWzBdXG4gICAgICBNZW1vcnkuY2hhbmdlIFwiZGF0YUZvbGRlclwiLCBuZXdGb2xkZXJcblxuICBNZW1vcnkuc3Vic2NyaWJlIFwiZGF0YUZvbGRlclwiLCB0cnVlLCAodiktPlxuICAgIHJldHVybiB1bmxlc3Mgdj9cbiAgICBkaXNwbGF5ID0gdlxuICAgIGRpc3BsYXkgPSBkaXNwbGF5LnJlcGxhY2UgRW52LmhvbWUsIFwiXCIgdW5sZXNzIGRpc3BsYXkgaXMgRW52LmhvbWVcbiAgICBkaXNwbGF5ID0gZGlzcGxheS5zbGljZSAxIGlmIGRpc3BsYXkuY2hhckF0KDApIGlzIFJlYWQuc2VwXG4gICAgZWxtcy5kYXRhRm9sZGVyLnRleHRDb250ZW50ID0gZGlzcGxheVxuICAgIGVsbXMucGF0aFJlYXNvbi50ZXh0Q29udGVudCA9IGlmIHYgaXMgRW52LmRlZmF1bHREYXRhRm9sZGVyXG4gICAgICBcIlRoaXMgRHJvcGJveCBmb2xkZXIgaXMgdGhlIGRlZmF1bHQ6XCJcbiAgICBlbHNlXG4gICAgICBcIlRoaXMgaXMgdGhlIGZvbGRlciB5b3Ugc2VsZWN0ZWQ6XCJcbiAgICBlbG1zLmV4aXN0aW5nQXNzZXRzLnRleHRDb250ZW50ID0gXCJTY2FubmluZyBhc3NldCBmb2xkZXLigKZcIlxuXG4gIGNsaWNrIFwiI2RhdGEtZm9sZGVyIFtuZXh0LWJ1dHRvbl1cIiwgKCktPlxuICAgIGRvIHRvIGlmIGF3YWl0IFJlYWQuaXNGb2xkZXIgTWVtb3J5IFwiZGF0YUZvbGRlclwiIHRoZW4gXCJleGlzdGluZy1hc3NldHNcIiBlbHNlIFwicGF0aC1lcnJvclwiXG5cbiAgIyBQYXRoIEVycm9yXG4gIGNsaWNrIFwiI3BhdGgtZXJyb3IgW2JhY2stYnV0dG9uXVwiLCB0byBcImRhdGEtZm9sZGVyXCJcblxuICAjIEV4aXN0aW5nIEFzc2V0c1xuICBjbGljayBcIiNleGlzdGluZy1hc3NldHMgW2JhY2stYnV0dG9uXVwiLCB0byBcImRhdGEtZm9sZGVyXCJcblxuICBNZW1vcnkuc3Vic2NyaWJlIFwiYXNzZXRzXCIsIHRydWUsICh2KS0+XG4gICAgcmV0dXJuIHVubGVzcyB2P1xuICAgIGNvdW50ID0gT2JqZWN0LmtleXModikubGVuZ3RoXG4gICAgZWxtcy5leGlzdGluZ0Fzc2V0cy50ZXh0Q29udGVudCA9IFN0cmluZy5wbHVyYWxpemUgY291bnQsIFwiRm91bmQgJSUgQXNzZXRcIlxuXG4gIGNsaWNrIFwiI2V4aXN0aW5nLWFzc2V0cyBbbmV4dC1idXR0b25dXCIsIHRvIFwibG9jYWwtbmFtZVwiXG5cbiAgIyBMb2NhbCBOYW1lXG4gIGNsaWNrIFwiI2xvY2FsLW5hbWUgW2JhY2stYnV0dG9uXVwiLCB0byBcImV4aXN0aW5nLWFzc2V0c1wiXG5cbiAgTWVtb3J5LnN1YnNjcmliZSBcImxvY2FsTmFtZVwiLCB0cnVlLCAodiktPlxuICAgIGVsbXMubG9jYWxOYW1lLnRleHRDb250ZW50ID0gdlxuXG4gIGxvY2FsTmFtZVZhbGlkID0gKCktPlxuICAgIHJldHVybiAtMSBpcyBlbG1zLmxvY2FsTmFtZS50ZXh0Q29udGVudC50cmltKCkuc2VhcmNoIC9bXlxcdyBdL1xuXG4gIGVsbXMubG9jYWxOYW1lLmFkZEV2ZW50TGlzdGVuZXIgXCJpbnB1dFwiLCAoZSktPlxuICAgIGVsbXMubG9jYWxOYW1lLmNsYXNzTmFtZSA9IGlmIGxvY2FsTmFtZVZhbGlkKCkgdGhlbiBcImZpZWxkXCIgZWxzZSBcImZpZWxkIGludmFsaWRcIlxuXG4gIGNsaWNrIFwiI2xvY2FsLW5hbWUgW25leHQtYnV0dG9uXVwiLCAoKS0+XG4gICAgdiA9IGVsbXMubG9jYWxOYW1lLnRleHRDb250ZW50LnRyaW0oKVxuICAgIHJldHVybiB1bmxlc3Mgdi5sZW5ndGggYW5kIGxvY2FsTmFtZVZhbGlkKClcbiAgICAjIFRPRE86IGNoZWNrIHdoZXRoZXIgYW55IGFzc2V0cyBhbHJlYWR5IGV4aXN0IHVzaW5nIHRoZSBsb2NhbCBuYW1lLiBJZiBzbywgc2hvdyBhIHdhcm5pbmcuIE90aGVyd2lzZS4uLlxuICAgIE1lbW9yeS5jaGFuZ2UgXCJsb2NhbE5hbWVcIiwgdlxuICAgIGRvIHRvIFwic2V0dXAtZG9uZVwiXG5cbiAgIyBTZXR1cCBEb25lXG4gIGNsaWNrIFwiI3NldHVwLWRvbmUgW2JhY2stYnV0dG9uXVwiLCB0byBcImxvY2FsLW5hbWVcIlxuICBjbGljayBcIiNzZXR1cC1kb25lIFtuZXh0LWJ1dHRvbl1cIiwgKCktPlxuICAgIE1lbW9yeS5jaGFuZ2UgXCJzZXR1cERvbmVcIiwgdHJ1ZVxuICAgIElQQy5zZW5kIFwiY29uZmlnLXJlYWR5XCJcbiAgICBJUEMuc2VuZCBcImNsb3NlLXdpbmRvd1wiXG4iXX0=
//# sourceURL=/Users/admin/Work/hyperzine/temp/setup-assistant.coffee